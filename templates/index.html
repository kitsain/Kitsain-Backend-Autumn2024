<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kitsain</title>
    <link rel="stylesheet" href="../static/index.css">
</head>
<body>

    <!-- Top bar -->
    <div class="top-bar d-flex align-items-center">
        <div class="profile-picture"></div>
        <h1 class="ml-2">
            <a href="{{ url_for('index') }}" style="text-decoration: none; color: inherit;">Kitsain</a>
        </h1>
        <input type="text" class="form-control search-box ml-3" placeholder="Search...">
        <form action="{{ url_for('products_page') }}" method="GET" class="d-inline">
            <button type="submit" class="btn btn-primary ml-2">Products</button>
        </form>
        <form >
            <button type="submit" class="btn btn-primary ml-2">Stores</button>
        </form>
        <button class="btn btn-success ml-2">Add</button>
        <form action="{{ url_for('my_profile_page') }}" method="GET" class="d-inline">
            <button class="btn btn-info ml-2">Profile</button>
        </form>
        <select class="ml-2">
            <option>EN</option>
            <option>FI</option>
            <!-- Add more languages as needed -->
        </select>
    </div>

    <!-- Central search box for products -->
    <div class="container mt-5 text-center">
        <h1 class="ml-3">Welcome to Kitsain</h1>
        <p class="ml-4">Find discounted products near you</p>
        <form action="{{ url_for('search_discount_method') }}" method="GET" class="action-form">
            <input type="text" class="form-control" name="query" placeholder="Search for products..." value="{{ request.args.get('query', '') }}">
            <button type="submit" class="search-button">Search</button>
        </form>
    </div>

    <!-- View Latest Updates container (if no search query) -->
    {% if not request.args.get('query') %}
        <div class="l_product_container mt-6 text-center">
            <h1 class="ml-6">Latest Updates</h1>
            <p class="ml-7">View already added products or add a product yourself</p>
            <!--product container-->
            {% include '_latest_product_container.html' %}
        </div>
    {% endif %}

    {% if request.args.get('query') %}
    <!-- Search results container with Remove Search button -->
    <div class="search_results_container mt-6 text-center">
        <div class="result_elements">
        <p class="ml-6 results">Found {{ results|length }} products matching your search</p>
        <button id="remove-search" class="remove-search-button">Remove Search</button>
        </div>
        {% include 'search_results.html' %}
    </div>
    {% endif %}

    <script>
        // Function to handle the "Remove Search" button click
        document.getElementById("remove-search")?.addEventListener("click", function(event) {
            // Prevent form submission
            event.preventDefault();
    
            // Clear the search input value (you could also reset any other necessary state)
            const searchInput = document.querySelector("input[name='query']");
            searchInput.value = '';
    
            // Simulate removing the search query and displaying the latest updates
            window.location.href = '/index';

        });
    </script>
    
    <!-- view all products container -->
    <div class="product_container mt-6 text-center">
        <h1 class="ml-6">View all products</h1>
        <p class="ml-7">Click here to view all products added so far</p>
        <form action="{{ url_for('products_page') }}" method="GET" class="action-form">
            <button type="submit" class="btn btn-primary view">View</button>
        </form>
    </div>

    <!-- Stores near you container -->
    <div class="store_container mt-6 text-center">
        <div class="store-text">
        <h1 class="ml-6">Stores near you</h1>
        <p class="ml-7">Find stores near you</p>
        </div>
        <div class="stores">
            <div class="store-container">
                <div class="icon-container">
                    <p class="store-icon">&#128205;</p>
                </div>
                <p class="store-name">Prisma Kaleva</p>
                <p class="store-hours">Open 24/7</p>
                <p class="store-address"><strong>Sammonkatu 75</strong></p>
            </div>
            <div class="store-container">
                <div class="icon-container">
                    <p class="store-icon">&#128722;</p>
                </div>
                <p class="store-name">K-Supermarket Kaleva</p>
                <p class="store-hours">10AM - 10PM</p>
                <p class="store-address"><strong>Sammonkatu 26</strong></p>
            </div>
        </div>        
    </div>

</body>
</html>
